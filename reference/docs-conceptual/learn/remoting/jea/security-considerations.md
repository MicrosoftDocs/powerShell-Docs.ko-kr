---
ms.date: 07/10/2019
keywords: jea,powershell,security
title: JEA 보안 고려 사항
description: JEA를 통해 사용자는 전체 관리자 액세스 권한을 갖지 않고도 관리 명령을 실행할 수 있으므로 높은 권한이 있는 보안 그룹에서 해당 사용자를 제거할 수 있습니다.
ms.openlocfilehash: f65f9d6c6620261de0a9c8de7812637565ca1806
ms.sourcegitcommit: 9080316e3ca4f11d83067b41351531672b667b7a
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/24/2020
ms.locfileid: "92501578"
---
# <a name="jea-security-considerations"></a><span data-ttu-id="c1f7e-104">JEA 보안 고려 사항</span><span class="sxs-lookup"><span data-stu-id="c1f7e-104">JEA Security Considerations</span></span>

<span data-ttu-id="c1f7e-105">JEA를 사용하면 컴퓨터의 영구 관리자 수를 줄여 보안 상태를 개선할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-105">JEA helps you improve your security posture by reducing the number of permanent administrators on your machines.</span></span> <span data-ttu-id="c1f7e-106">JEA는 PowerShell 세션 구성을 사용하여 시스템을 관리할 수 있는 사용자에 대한 새 진입점을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-106">JEA uses a PowerShell session configuration to create a new entry point for users to manage the system.</span></span> <span data-ttu-id="c1f7e-107">관리 작업을 수행하기 위해 머신에 대한 상승된(그러나 제한되지는 않은) 액세스 권한이 필요한 사용자에게 JEA 엔드포인트에 대한 액세스 권한을 부여할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-107">Users who need elevated, but not unlimited, access to the machine to do administrative tasks can be granted access to the JEA endpoint.</span></span> <span data-ttu-id="c1f7e-108">JEA를 통해 사용자는 전체 관리자 액세스 권한을 갖지 않고도 관리 명령을 실행할 수 있으므로 높은 권한이 있는 보안 그룹에서 해당 사용자를 제거할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-108">Since JEA allows these users to run admin commands without having full admin access, you can then remove those users from highly privileged security groups.</span></span>

## <a name="run-as-account"></a><span data-ttu-id="c1f7e-109">실행 계정</span><span class="sxs-lookup"><span data-stu-id="c1f7e-109">Run-As account</span></span>

<span data-ttu-id="c1f7e-110">각 JEA 엔드포인트에는 지정된 **실행** 계정이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-110">Each JEA endpoint has a designated **run-as** account.</span></span> <span data-ttu-id="c1f7e-111">이는 연결하는 사용자의 작업이 실행되는 계정입니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-111">This is the account under which the connecting user's actions are executed.</span></span> <span data-ttu-id="c1f7e-112">이 계정은 [세션 구성 파일](session-configurations.md)에서 구성할 수 있으며, 선택한 계정은 엔드포인트의 보안에 상당한 영향을 줍니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-112">This account is configurable in the [session configuration file](session-configurations.md), and the account you choose has a significant bearing on the security of your endpoint.</span></span>

<span data-ttu-id="c1f7e-113">**가상 계정** 은 **실행** 계정을 구성하는 권장 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-113">**Virtual accounts** are the recommended way of configuring the **run-as** account.</span></span> <span data-ttu-id="c1f7e-114">가상 계정은 연결하는 사용자가 JEA 세션 기간 동안 사용하도록 만들어지는 일회성 임시 로컬 계정입니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-114">Virtual accounts are one-time, temporary local accounts that are created for the connecting user to use during the duration of their JEA session.</span></span> <span data-ttu-id="c1f7e-115">해당 세션이 종료되는 즉시 가상 계정은 제거되고 더 이상 사용할 수 없게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-115">As soon as their session is terminated, the virtual account is destroyed and can't be used anymore.</span></span> <span data-ttu-id="c1f7e-116">연결하는 사용자는 가상 계정의 자격 증명을 알지 못합니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-116">The connecting user doesn't know the credentials for the virtual account.</span></span> <span data-ttu-id="c1f7e-117">가상 계정은 원격 데스크톱 또는 비제한 PowerShell 엔드포인트와 같은 다른 방법을 통해 시스템에 액세스하는 데 사용할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-117">The virtual account can't be used to access the system via other means like Remote Desktop or an unconstrained PowerShell endpoint.</span></span>

<span data-ttu-id="c1f7e-118">기본적으로 가상 계정은 머신의 로컬 **관리자** 그룹에 속합니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-118">By default, virtual accounts belong to the local **Administrators** group on the machine.</span></span> <span data-ttu-id="c1f7e-119">따라서 시스템의 모든 항목을 관리할 수 있는 모든 권한은 있지만, 네트워크의 리소스를 관리할 수 있는 권한은 없습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-119">This gives them full rights to manage anything on the system, but no rights to manage resources on the network.</span></span>
<span data-ttu-id="c1f7e-120">다른 머신에서 인증할 때 사용자 컨텍스트는 가상 계정이 아니라 로컬 컴퓨터 계정이 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-120">When authenticating with other machines, the user context is that of the local computer account, not the virtual account.</span></span>

<span data-ttu-id="c1f7e-121">도메인 컨트롤러는 로컬 **관리자** 그룹이 없으므로 특수한 경우입니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-121">Domain controllers are a special case since there isn't a local **Administrators** group.</span></span> <span data-ttu-id="c1f7e-122">대신, 가상 계정은 **Domain Admins** 에 속하며 도메인 컨트롤러에서 디렉터리 서비스를 관리할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-122">Instead, virtual accounts belong to **Domain Admins** and can manage the directory services on the domain controller.</span></span> <span data-ttu-id="c1f7e-123">도메인 ID는 여전히 JEA 세션이 인스턴스화된 도메인 컨트롤러에서 사용할 수 있도록 제한됩니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-123">The domain identity is still restricted for use on the domain controller where the JEA session was instantiated.</span></span> <span data-ttu-id="c1f7e-124">모든 네트워크 액세스는 대신 도메인 컨트롤러 컴퓨터 개체에서 온 것으로 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-124">Any network access appears to come from the domain controller computer object instead.</span></span>

<span data-ttu-id="c1f7e-125">두 경우 모두 가상 계정이 속한 보안 그룹을 명시적으로 정의할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-125">In both cases, you may explicitly define which security groups the virtual account belongs to.</span></span> <span data-ttu-id="c1f7e-126">이는 로컬 또는 도메인 관리자 권한 없이 작업을 수행될 수 있는 좋은 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-126">This is a good practice when the task can be done without local or domain admin privileges.</span></span> <span data-ttu-id="c1f7e-127">이미 관리자에 대해 정의된 보안 그룹이 있는 경우 해당 그룹에 가상 계정 멤버 자격을 부여합니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-127">If you already have a security group defined for your admins, grant the virtual account membership to that group.</span></span> <span data-ttu-id="c1f7e-128">가상 계정 그룹 멤버 자격은 워크스테이션 및 멤버 서버의 로컬 보안 그룹으로 제한됩니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-128">Virtual account group membership is limited to local security groups on workstation and member servers.</span></span> <span data-ttu-id="c1f7e-129">도메인 컨트롤러에서 가상 계정은 도메인 보안 그룹의 멤버여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-129">On domain controllers, virtual accounts must be members of domain security groups.</span></span>
<span data-ttu-id="c1f7e-130">가상 계정이 하나 이상의 보안 그룹에 추가되면 더 이상 기본 그룹(로컬 또는 도메인 관리자)에 속하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-130">Once the virtual account has been added to one or more security groups, it no longer belongs to the default groups (local or domain admins).</span></span>

<span data-ttu-id="c1f7e-131">다음 표에는 가능한 구성 옵셥과 가상 계정에 대한 해당 사용 권한이 요약되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-131">The following table summarizes the possible configuration options and resulting permissions for virtual accounts:</span></span>

|        <span data-ttu-id="c1f7e-132">컴퓨터 유형</span><span class="sxs-lookup"><span data-stu-id="c1f7e-132">Computer type</span></span>         | <span data-ttu-id="c1f7e-133">가상 계정 그룹 구성</span><span class="sxs-lookup"><span data-stu-id="c1f7e-133">Virtual account group configuration</span></span> |                   <span data-ttu-id="c1f7e-134">로컬 사용자 컨텍스트</span><span class="sxs-lookup"><span data-stu-id="c1f7e-134">Local user context</span></span>                    | <span data-ttu-id="c1f7e-135">네트워크 사용자 컨텍스트</span><span class="sxs-lookup"><span data-stu-id="c1f7e-135">Network user context</span></span> |
| ---------------------------- | ----------------------------------- | ------------------------------------------------------- | -------------------- |
| <span data-ttu-id="c1f7e-136">도메인 컨트롤러</span><span class="sxs-lookup"><span data-stu-id="c1f7e-136">Domain controller</span></span>            | <span data-ttu-id="c1f7e-137">Default</span><span class="sxs-lookup"><span data-stu-id="c1f7e-137">Default</span></span>                             | <span data-ttu-id="c1f7e-138">도메인 사용자, ' *DOMAIN* \Domain Admins'의 구성원</span><span class="sxs-lookup"><span data-stu-id="c1f7e-138">Domain user, member of ' *DOMAIN* \Domain Admins'</span></span>         | <span data-ttu-id="c1f7e-139">컴퓨터 계정</span><span class="sxs-lookup"><span data-stu-id="c1f7e-139">Computer account</span></span>     |
| <span data-ttu-id="c1f7e-140">도메인 컨트롤러</span><span class="sxs-lookup"><span data-stu-id="c1f7e-140">Domain controller</span></span>            | <span data-ttu-id="c1f7e-141">도메인 그룹 A 및 B</span><span class="sxs-lookup"><span data-stu-id="c1f7e-141">Domain groups A and B</span></span>               | <span data-ttu-id="c1f7e-142">도메인 사용자, ' *DOMAIN* \A', ' *DOMAIN* \B'의 구성원</span><span class="sxs-lookup"><span data-stu-id="c1f7e-142">Domain user, member of ' *DOMAIN* \A', ' *DOMAIN* \B'</span></span>       | <span data-ttu-id="c1f7e-143">컴퓨터 계정</span><span class="sxs-lookup"><span data-stu-id="c1f7e-143">Computer account</span></span>     |
| <span data-ttu-id="c1f7e-144">구성원 서버 또는 워크스테이션</span><span class="sxs-lookup"><span data-stu-id="c1f7e-144">Member server or workstation</span></span> | <span data-ttu-id="c1f7e-145">Default</span><span class="sxs-lookup"><span data-stu-id="c1f7e-145">Default</span></span>                             | <span data-ttu-id="c1f7e-146">로컬 사용자, ' *BUILTIN* \Administrators'의 구성원</span><span class="sxs-lookup"><span data-stu-id="c1f7e-146">Local user, member of ' *BUILTIN* \Administrators'</span></span>        | <span data-ttu-id="c1f7e-147">컴퓨터 계정</span><span class="sxs-lookup"><span data-stu-id="c1f7e-147">Computer account</span></span>     |
| <span data-ttu-id="c1f7e-148">구성원 서버 또는 워크스테이션</span><span class="sxs-lookup"><span data-stu-id="c1f7e-148">Member server or workstation</span></span> | <span data-ttu-id="c1f7e-149">로컬 그룹 C 및 D</span><span class="sxs-lookup"><span data-stu-id="c1f7e-149">Local groups C and D</span></span>                | <span data-ttu-id="c1f7e-150">로컬 사용자, ' *COMPUTER* \C' 및 ' *COMPUTER* \D'의 구성원</span><span class="sxs-lookup"><span data-stu-id="c1f7e-150">Local user, member of ' *COMPUTER* \C' and ' *COMPUTER* \D'</span></span> | <span data-ttu-id="c1f7e-151">컴퓨터 계정</span><span class="sxs-lookup"><span data-stu-id="c1f7e-151">Computer account</span></span>     |

<span data-ttu-id="c1f7e-152">보안 감사 이벤트 및 애플리케이션 이벤트 로그를 보면 각 JEA 사용자 세션에 고유 가상 계정이 있음을 알 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-152">When you look at security audit events and application event logs, you see that each JEA user session has a unique virtual account.</span></span> <span data-ttu-id="c1f7e-153">이 고유한 계정은 JEA 엔드포인트에서 명령을 실행한 원래 사용자까지 거슬러 올라가 추적하는 데 도움이 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-153">This unique account helps you track user actions in a JEA endpoint back to the original user who ran the command.</span></span> <span data-ttu-id="c1f7e-154">가상 계정 이름은 `WinRM Virtual Users\WinRM_VA_<ACCOUNTNUMBER>_<DOMAIN>_<sAMAccountName>` 형식을 따릅니다. 예를 들어 도메인 **Contoso** 의 사용자 **Alice** 가 JEA 엔드포인트에서 서비스를 다시 시작하면 모든 서비스 제어 관리자 이벤트와 연결된 사용자 이름은 `WinRM Virtual Users\WinRM_VA_1_contoso_alice`가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-154">Virtual account names follow the format `WinRM Virtual Users\WinRM_VA_<ACCOUNTNUMBER>_<DOMAIN>_<sAMAccountName>` For example, if user **Alice** in domain **Contoso** restarts a service in a JEA endpoint, the username associated with any service control manager events would be `WinRM Virtual Users\WinRM_VA_1_contoso_alice`.</span></span>

<span data-ttu-id="c1f7e-155">**gMSA(그룹 관리 서비스 계정)** 는 구성원 서버가 JEA 세션에서 네트워크 리소스에 대한 액세스 권한을 가져야 할 경우에 유용합니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-155">**Group-managed service accounts (gMSAs)** are useful when a member server needs to have access to network resources in the JEA session.</span></span> <span data-ttu-id="c1f7e-156">예를 들어 JEA 엔드포인트를 사용하여 다른 머신에 호스트되는 REST API 서비스에 대한 액세스를 제어하는 경우</span><span class="sxs-lookup"><span data-stu-id="c1f7e-156">For example, when a JEA endpoint is used to control access to a REST API service hosted on a different machine.</span></span> <span data-ttu-id="c1f7e-157">REST API를 호출하는 함수를 작성하는 것은 쉽지만 API로 인증하려면 네트워크 ID가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-157">It's easy to write functions to invoke the REST APIs, but you need a network identity to authenticate with the API.</span></span> <span data-ttu-id="c1f7e-158">그룹 관리 서비스 계정을 사용하면 계정을 사용할 수 있는 컴퓨터를 유지 관리하면서 두 번째 홉을 가능하게 합니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-158">Using a group-managed service account makes the second hop possible while maintaining control over which computers can use the account.</span></span> <span data-ttu-id="c1f7e-159">gMSA의 유효 권한은 gMSA 계정이 속하는 보안 그룹(로컬 또는 도메인)에 의해 정의됩니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-159">The effective permissions of the gMSA are defined by the security groups (local or domain) to which the gMSA account belongs.</span></span>

<span data-ttu-id="c1f7e-160">JEA 엔드포인트가 gMSA를 사용하도록 구성된 경우 모든 JEA 사용자의 작업은 같은 gMSA에서 온 것으로 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-160">When a JEA endpoint is configured to use a gMSA, the actions of all JEA users appear to come from the same gMSA.</span></span> <span data-ttu-id="c1f7e-161">특정 사용자까지 거슬러 올라가 작업을 추적하는 유일한 방법은 PowerShell 세션 기록에서 실행된 명령 세트를 식별하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-161">The only way to trace actions back to a specific user is to identify the set of commands run in a PowerShell session transcript.</span></span>

<span data-ttu-id="c1f7e-162">**Pass-thru 자격 증명** 은 **실행** 계정을 지정하지 않은 경우에 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-162">**Pass-thru credentials** are used when you don't specify a **run-as** account.</span></span> <span data-ttu-id="c1f7e-163">PowerShell은 연결하는 사용자의 자격 증명을 사용하여 원격 서버에서 명령을 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-163">PowerShell uses the connecting user's credential to run commands on the remote server.</span></span> <span data-ttu-id="c1f7e-164">이를 위해서는 연결하는 사용자에게 권한 있는 관리 그룹에 대한 액세스 권한을 직접 부여해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-164">This requires you to grant the connecting user direct access to privileged management groups.</span></span> <span data-ttu-id="c1f7e-165">이 구성은 JEA에 권장되지 **않습니다** .</span><span class="sxs-lookup"><span data-stu-id="c1f7e-165">This configuration is **not** recommended for JEA.</span></span> <span data-ttu-id="c1f7e-166">연결하는 사용자에게 이미 관리자 권한이 있으면 JEA를 피하고 다른 비제한 방법을 통해 시스템을 관리할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-166">If the connecting user already has admin privileges, they can avoid JEA and manage the system via other, unconstrained means.</span></span> <span data-ttu-id="c1f7e-167">자세한 내용은 [JEA는 관리자로부터 보호하지 않음](#jea-doesnt-protect-against-admins) 방법에 대한 아래 섹션을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-167">For more information, see the section below on how [JEA doesn't protect against admins](#jea-doesnt-protect-against-admins).</span></span>

<span data-ttu-id="c1f7e-168">**표준 실행 계정** 을 사용하면 전체 PowerShell 세션이 실행되는 사용자 계정을 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-168">**Standard run-as accounts** allow you to specify any user account under which the entire PowerShell session runs.</span></span> <span data-ttu-id="c1f7e-169">고정 **실행** 계정(`-RunAsCredential` 매개 변수 포함)을 사용하는 세션 구성은 JEA를 인식하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-169">Session configurations using fixed **run-as** accounts (with the `-RunAsCredential` parameter) aren't JEA-aware.</span></span> <span data-ttu-id="c1f7e-170">역할 정의가 더 이상 예상대로 작동하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-170">Role definitions no longer function as expected.</span></span> <span data-ttu-id="c1f7e-171">엔드포인트에 액세스할 수 있는 권한이 부여된 모든 사용자에게 동일한 역할이 할당됩니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-171">Every user authorized to access the endpoint is assigned the same role.</span></span>

<span data-ttu-id="c1f7e-172">특정 사용자까지 거슬러 올라가 작업을 추적하는 어려움이 있고 사용자를 역할에 매핑하기 위한 지원이 부족하기 때문에 JEA 엔드포인트에서 **RunAsCredential** 을 사용하면 안 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-172">You shouldn't use a **RunAsCredential** on a JEA endpoint because it's difficult to trace actions back to specific users and lacks support for mapping users to roles.</span></span>

## <a name="winrm-endpoint-acl"></a><span data-ttu-id="c1f7e-173">WinRM 엔드포인트 ACL</span><span class="sxs-lookup"><span data-stu-id="c1f7e-173">WinRM Endpoint ACL</span></span>

<span data-ttu-id="c1f7e-174">일반 PowerShell 원격 엔드포인트와 마찬가지로 각 JEA 엔드포인트에는 JEA 엔드포인트로 인증할 수 있는 사용자를 제어하는 별도의 ACL(액세스 제어 목록)이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-174">As with regular PowerShell remoting endpoints, each JEA endpoint has a separate access control list (ACL) that controls who can authenticate with the JEA endpoint.</span></span> <span data-ttu-id="c1f7e-175">잘못 구성된 경우 신뢰할 수 있는 사용자가 JEA 엔드포인트에 액세스하지 못할 수 있으며 신뢰할 수 없는 사용자가 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-175">If improperly configured, trusted users may not be able to access the JEA endpoint and untrusted users may have access.</span></span> <span data-ttu-id="c1f7e-176">WinRM ACL은 JEA 역할에 대한 사용자 매핑에는 영향을 주지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-176">The WinRM ACL doesn't affect the mapping of users to JEA roles.</span></span> <span data-ttu-id="c1f7e-177">매핑은 엔드포인트를 등록하는 데 사용되는 세션 구성 파일의 **RoleDefinitions** 필드에 의해 제어됩니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-177">Mapping is controlled by the **RoleDefinitions** field in the session configuration file used to register the endpoint.</span></span>

<span data-ttu-id="c1f7e-178">기본적으로 JEA 엔드포인트에 여러 역할 기능이 있는 경우 WinRM ACL은 매핑된 모든 사용자에 대한 액세스를 허용하도록 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-178">By default, when a JEA endpoint has multiple role capabilities, the WinRM ACL is configured to allow access to all mapped users.</span></span> <span data-ttu-id="c1f7e-179">예를 들어 다음 명령을 사용하여 구성된 JEA 세션은 `CONTOSO\JEA_Lev1` 및 `CONTOSO\JEA_Lev2`에 대한 모든 액세스 권한을 부여합니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-179">For example, a JEA session configured using the following commands grants full access to `CONTOSO\JEA_Lev1` and `CONTOSO\JEA_Lev2`.</span></span>

```powershell
$roles = @{ 'CONTOSO\JEA_Lev1' = 'Lev1Role'; 'CONTOSO\JEA_Lev2' = 'Lev2Role' }
New-PSSessionConfigurationFile -Path '.\jea.pssc' -SessionType RestrictedRemoteServer -RoleDefinitions $roles -RunAsVirtualAccount
Register-PSSessionConfiguration -Path '.\jea.pssc' -Name 'MyJEAEndpoint'
```

<span data-ttu-id="c1f7e-180">[Get-PSSessionConfiguration](/powershell/module/microsoft.powershell.core/get-pssessionconfiguration) cmdlet을 사용하여 사용자 권한을 감사할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-180">You can audit user permissions with the [Get-PSSessionConfiguration](/powershell/module/microsoft.powershell.core/get-pssessionconfiguration) cmdlet.</span></span>

```powershell
Get-PSSessionConfiguration -Name 'MyJEAEndpoint' | Select-Object Permission
```

```Output
Permission
----------
CONTOSO\JEA_Lev1 AccessAllowed
CONTOSO\JEA_Lev2 AccessAllowed
```

<span data-ttu-id="c1f7e-181">액세스 권한을 갖는 사용자를 변경하려면 `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI`를 실행하여 대화형 프롬프트를 사용하거나 `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>`을 실행하여 사용 권한을 업데이트합니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-181">To change which users have access, run either `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` for an interactive prompt or `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` to update the permissions.</span></span> <span data-ttu-id="c1f7e-182">JEA 엔드포인트에 액세스하려면 사용자에게 최소한 *Invoke* 권한이 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-182">Users need at least *Invoke* rights to access the JEA endpoint.</span></span>

<span data-ttu-id="c1f7e-183">정의된 역할을 액세스 권한이 있는 모든 사용자에게 매핑하지 않는 JEA 엔드포인트를 만드는 것이 가능합니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-183">It's possible to create a JEA endpoint that doesn't map a defined role to every user that has access.</span></span> <span data-ttu-id="c1f7e-184">이러한 사용자는 JEA 세션을 시작할 수 있지만 기본 cmdlet에만 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-184">These users can start a JEA session, but only have access to the default cmdlets.</span></span> <span data-ttu-id="c1f7e-185">`Get-PSSessionCapability`를 실행하여 JEA 엔드포인트의 사용자 권한을 감사할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-185">You can audit user permissions in a JEA endpoint by running `Get-PSSessionCapability`.</span></span> <span data-ttu-id="c1f7e-186">자세한 내용은 [JEA에 대한 감사 및 보고](audit-and-report.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-186">For more information, see [Auditing and Reporting on JEA](audit-and-report.md).</span></span>

## <a name="least-privilege-roles"></a><span data-ttu-id="c1f7e-187">최소 권한 역할</span><span class="sxs-lookup"><span data-stu-id="c1f7e-187">Least privilege roles</span></span>

<span data-ttu-id="c1f7e-188">JEA 역할을 디자인할 때는 백그라운드에서 실행되는 가상 및 그룹 관리 서비스 계정이 로컬 머신에 제한 없이 액세스할 수 있다는 점을 기억해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-188">When designing JEA roles, it's important to remember that the virtual and group-managed service accounts running behind the scenes can have unrestricted access to the local machine.</span></span> <span data-ttu-id="c1f7e-189">JEA 역할 기능은 해당 권한 컨텍스트에서 실행할 수 있는 명령과 애플리케이션을 제한하는 데 도움이 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-189">JEA role capabilities help limit the commands and applications that can be run in that privileged context.</span></span>
<span data-ttu-id="c1f7e-190">잘못 디자인된 역할은 사용자가 JEA 경계를 벗어나거나 중요한 정보에 액세스할 수 있는 위험한 명령을 허용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-190">Improperly designed roles can allow dangerous commands that may permit a user to break out of the JEA boundaries or obtain access to sensitive information.</span></span>

<span data-ttu-id="c1f7e-191">예를 들어 다음과 같은 역할 기능 항목을 생각해 봅니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-191">For example, consider the following role capability entry:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\*-Process'
}
```

<span data-ttu-id="c1f7e-192">이 역할 기능을 통해 사용자는 **Microsoft.PowerShell.Management** 모듈에서 명사 **Process** 를 사용하여 모든 PowerShell cmdlet을 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-192">This role capability allows users to run any PowerShell cmdlet with the noun **Process** from the **Microsoft.PowerShell.Management** module.</span></span> <span data-ttu-id="c1f7e-193">사용자는 `Get-Process`와 같은 cmdlet에 액세스하여 시스템에서 실행되고 있는 애플리케이션을 확인하고 `Stop-Process`에 액세스하여 응답 없는 애플리케이션을 종료해야 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-193">Users may need to access cmdlets like `Get-Process` to see what applications are running on the system and `Stop-Process` to kill applications that aren't responding.</span></span> <span data-ttu-id="c1f7e-194">그러나 이 항목은 전체 관리자 권한으로 임의 프로그램을 시작하는 데 사용될 수 있는 `Start-Process`도 허용합니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-194">However, this entry also allows `Start-Process`, which can be used to start up an arbitrary program with full administrator permissions.</span></span> <span data-ttu-id="c1f7e-195">프로그램을 시스템에 로컬로 설치할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-195">The program doesn't need to be installed locally on the system.</span></span> <span data-ttu-id="c1f7e-196">연결된 사용자는 사용자에게 로컬 관리자 권한을 부여하고 맬웨어를 실행하는 파일 공유에서 프로그램을 시작할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-196">A connected user could start a program from a file share that gives the user local admin privileges, runs malware, and more.</span></span>

<span data-ttu-id="c1f7e-197">이 역할 기능의 더 안전한 버전은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-197">A more secure version of this same role capability would look like:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\Get-Process', 'Microsoft.PowerShell.Management\Stop-Process'
}
```

<span data-ttu-id="c1f7e-198">역할 기능에 와일드카드를 사용하지 마세요.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-198">Avoid using wildcards in role capabilities.</span></span> <span data-ttu-id="c1f7e-199">정기적으로 [유효한 사용자 권한을 감사](audit-and-report.md#check-effective-rights-for-a-specific-user)하여 사용자가 액세스할 수 있는 명령을 파악하세요.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-199">Be sure to regularly [audit effective user permissions](audit-and-report.md#check-effective-rights-for-a-specific-user) to understand which commands are accessible to the user.</span></span>

## <a name="jea-doesnt-protect-against-admins"></a><span data-ttu-id="c1f7e-200">JEA는 관리자로부터 보호하지 않음</span><span class="sxs-lookup"><span data-stu-id="c1f7e-200">JEA doesn't protect against admins</span></span>

<span data-ttu-id="c1f7e-201">JEA의 핵심 원칙 중 하나는 관리자가 아닌 사용자가 일부 관리 작업을 수행할 수 있도록 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-201">One of the core principles of JEA is that it allows non-admins to do some admin tasks.</span></span> <span data-ttu-id="c1f7e-202">JEA는 이미 관리자 권한이 있는 사용자로부터 보호하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-202">JEA doesn't protect against users who already have administrator privileges.</span></span> <span data-ttu-id="c1f7e-203">**Domain Admins** , 로컬 **관리자** 또는 기타 높은 권한 있는 그룹에 속한 사용자는 다른 방법을 통해 JEA의 보호를 우회할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-203">Users who belong **Domain Admins** , local **Administrators** , or other highly privileged groups can circumvent JEA's protections via another means.</span></span> <span data-ttu-id="c1f7e-204">예를 들어 RDP를 사용하여 로그인하거나 원격 MMC 콘솔을 사용하거나 비제한 PowerShell 엔드포인트에 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-204">For example, they could sign in with RDP, use remote MMC consoles, or connect to unconstrained PowerShell endpoints.</span></span> <span data-ttu-id="c1f7e-205">또한 시스템의 로컬 관리자는 JEA 구성을 수정하여 추가 사용자를 허용하거나 사용자가 해당 JEA 세션에서 수행할 수 있는 작업의 범위를 확장할 수 있도록 역할 기능을 변경할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-205">Also, local admins on a system can modify JEA configurations to allow additional users or change a role capability to extend the scope of what a user can do in their JEA session.</span></span> <span data-ttu-id="c1f7e-206">JEA 사용자의 확장된 사용 권한을 평가하여 시스템에 대한 권한 있는 액세스 권한을 얻는 다른 방법이 있는지 확인해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-206">It's important to evaluate your JEA users' extended permissions to see if there are other ways to gain privileged access to the system.</span></span>

<span data-ttu-id="c1f7e-207">일반적인 방법은 정기적인 일상 유지 관리에는 JEA를 사용하고 비상 상황에서 사용자가 일시적으로 로컬 관리자가 될 수 있도록 하는 Just In Time 권한 있는 액세스 권한 관리 솔루션을 사용하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-207">A common practice is to use JEA for regular day-to-day maintenance and have a just-in-time, privileged access management solution that allows users to temporarily become local admins in emergency situations.</span></span> <span data-ttu-id="c1f7e-208">이렇게 하면 사용자가 시스템에서 영구 관리자가 아니지만, 해당 권한 사용을 문서화하는 워크플로를 완료하는 경우에만 해당 권한을 얻을 수 있도록 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c1f7e-208">This helps ensure users aren't permanent admins on the system, but can get those rights if, and only when, they complete a workflow that documents their use of those permissions.</span></span>
