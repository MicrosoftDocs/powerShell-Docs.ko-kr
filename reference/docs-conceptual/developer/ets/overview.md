---
title: 확장 유형 시스템 개요
ms.date: 07/09/2020
ms.openlocfilehash: 5c190f0d9b852a4b5658227085092f33d71453c9
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/05/2020
ms.locfileid: "87786223"
---
# <a name="extended-type-system-overview"></a>확장 유형 시스템 개요

PowerShell은 **PSObject** 개체를 사용 하 여 두 가지 방법으로 개체 유형을 확장 합니다. 첫째, **PSObject** 개체는 특정 개체 유형의 여러 보기를 표시 하는 방법을 제공 합니다. 이를 개체의 조정 된 뷰로 표시 라고 합니다. 그런 다음 **PSObject** 개체는 기존 개체에 멤버를 추가 하는 방법을 제공 합니다. **PSObject** 개체는 기본 개체 라고 하는 기존 개체를 래핑하여 스크립트와 cmdlet 개발자가 셸 내에서 .net 개체를 조작 하는 데 사용할 수 있는 추가 기능 (확장 형식 시스템)을 제공 합니다.

## <a name="cmdlet-and-script-development-issues"></a>Cmdlet 및 스크립트 개발 문제

작업은 두 가지 근본적인 문제를 해결 합니다.

첫째, 일부 .NET 개체에는 cmdlet 간 데이터 역할을 수행 하는 데 필요한 기본 동작이 없습니다.

- 일부 .NET 개체는 해당 멤버가 포함 하는 데이터를 설명 하는 "메타" 개체 (예: WMI 개체, ADO 개체 및 XML 개체)입니다. 그러나 스크립팅 환경에서는 포함 된 데이터에 대 한 설명이 아니라 가장 흥미로운 포함 된 데이터입니다. 필요한 기본 의미 체계를 갖도록 기본 .NET 개체를 조정 하는 어댑터의 개념을 도입 하 여이 문제를 해결 합니다.
- 일부 .NET 개체 멤버의 이름이 일관 되지 않거나, 충분 하지 않은 public 멤버 집합을 제공 하거나, 충분 하지 않은 기능을 제공 합니다. 추가 멤버를 사용 하 여 .NET 개체를 확장할 수 있는 기능을 도입 하 여이 문제를 해결 합니다.

둘째, 특정 형식으로 변수를 선언 하지 않아도 되도록 PowerShell 스크립팅 언어는 _관대_ 하지 않습니다. 즉, 스크립트 개발자가 만드는 변수 _는 특성 형식이 아닙니다._ 그러나 PowerShell 시스템은 결과를 출력 하거나 정렬 하는 등의 기본 작업에 대해 작동 하는 형식 이름이 있는지 여부에 따라 달라 집니다.

따라서 스크립트 개발자는 변수의 형식에 대 한 상태를 지정 하 고 속성 및 메서드를 포함 하며 형식 기반 시스템에 참여할 수 있는 동적으로 형식화 된 "개체" 집합을 직접 작성할 수 있어야 합니다. 이 문제를 해결 하려면 해당 형식의 상태를 동적으로 추가 하 고 동적으로 멤버를 추가 하는 기능이 있는 스크립트 언어에 대 한 공통 개체를 제공 합니다.

기본적으로는 스크립트 언어에서 모든 개체 액세스의 기반 역할을 하 고 cmdlet 개발자를 위한 표준 추상화를 제공 하는 **PSObject** 개체를 제공 하 여 이전에 언급 한 문제를 해결 합니다.

### <a name="cmdlet-developers"></a>Cmdlet 개발자

Cmdlet 개발자의 경우에는 다음을 지원 합니다.

- **PSObject** 개체를 사용 하 여 일반적인 방식으로 개체에 대해 작동 하는 추상화입니다. 또한 필요에 맞게 이러한 추상화를 지 원하는 기능을 제공 합니다.
- 잘 알려진 확장 멤버 집합을 사용 하 여 개체 형식의 형식 지정, 정렬, serialization 및 기타 시스템 조작을 위한 기본 동작을 만드는 메커니즘입니다.
- 는 Languageprimitives.physicalhash 개체를 사용 하 여 스크립트 언어와 동일한 의미 체계를 사용 하는 모든 개체에 대해 작동 하는 수단입니다.
- 는 해시 테이블을 동적으로 "형식" 하 여 시스템의 나머지 부분이 효율적으로 작동할 수 있도록 하는 것을 의미 합니다.

### <a name="script-developers"></a>개발자 스크립트

스크립트 개발자의 경우에는 다음을 지원 합니다.

- 동일한 구문 ()을 사용 하 여 기본 개체 형식을 참조할 수 `$a.x` 있습니다.
- **PSObject** 개체에서 제공 하는 추상화를 초과 하 여에 액세스 하는 기능 (예: 조정 된 멤버만 액세스 하거나 기본 개체 자체에 액세스)
- 개체 인스턴스나 형식의 형식 지정, 정렬, serialization 및 기타 조작을 제어 하는 잘 알려진 멤버를 정의 하는 기능입니다.
- 는 개체의 이름을 특정 형식으로 지정 하 여 해당 형식 기반 멤버의 상속을 제어 하는 것을 의미 합니다.
- 확장 멤버를 추가, 제거 및 수정할 수 있는 권한입니다.
- 필요한 경우 **PSObject** 개체 자체를 조작 하는 기능입니다.

## <a name="the-psobject-class"></a>PSObject 클래스

**PSObject** 개체는 스크립트 언어에서 제공 하는 모든 개체 액세스의 기반이 되며 cmdlet 개발자를 위한 표준 추상화를 제공 합니다. 여기에는 기본 개체 (.NET 개체) 및 모든 인스턴스 멤버 (특정 개체 인스턴스에 존재 하는 동일한 형식의 다른 개체에는 없는 멤버, 구체적으로 확장 된 멤버)가 포함 됩니다. 기본 개체의 형식에 따라 **PSObject** 개체는 조정 된 멤버 뿐만 아니라 모든 형식 기반 확장 멤버에 대해 암시적 및 명시적 액세스를 제공할 수도 있습니다.

**PSObject** 개체는 다음과 같은 메커니즘을 제공 합니다.

- 기본 개체를 사용 하거나 사용 하지 않고 **PSObject** 를 생성 하는 기능입니다.
- 공통 조회 알고리즘을 통해 생성 된 각 **PSObject** 개체의 모든 멤버에 액세스할 수 있는 기능 및 필요한 경우 해당 알고리즘을 재정의할 수 있습니다.
- 생성 된 **psobject** 개체의 형식 이름을 가져오고 설정 하는 기능을 통해 해당 기본 개체의 형식에 관계 없이 스크립트와 cmdlet이 동일한 형식 이름으로 비슷한 **PSObject** 개체를 참조할 수 있습니다.

### <a name="how-to-construct-a-psobject"></a>PSObject를 구성 하는 방법

다음 목록에서는 **PSObject** 개체를 만드는 방법을 설명 합니다.

- #Ctor 생성자를 **호출 하면 PSCustomObject** 의 기본 개체를 사용 하 여 새 **PSObject** 개체가 만들어집니다. 이 형식의 기본 개체는 **PSObject** 개체에 의미 있는 기본 개체가 없다는 것을 나타냅니다. 그러나이 형식의 기본 개체를 사용 하는 **PSObject** 개체는 cmdlet 개발자가 확장 멤버를 추가 하 여 유용한 속성 모음을 제공 합니다.

또한 개발자는이 개체가 확장 멤버를 동일한 형식 이름의 다른 **PSObject** 개체와 공유할 수 있도록 하는 개체 형식 이름을 지정할 수 있습니다.

- **PSObject** . #ctor (system.object) 생성자를 호출 하면 system.object 형식의 기본 개체를 사용 하 여 새 **PSObject** 개체가 만들어집니다.

  이 경우 만들어진 개체의 형식 이름은 기본 개체의 파생 계층 구조 컬렉션입니다. 예를 들어 ProcessInfo 기본 개체를 포함 하는 **PSObject** 의 유형 이름에는 다음 이름이 포함 됩니다.

  - System.Diagnostics.Process
  - System.componentmodel. 구성 요소
  - System.MarshalByRefObject
  - System.Object

- **PSObject** 를 호출 합니다. 개체 (System.object) 메서드는 제공 된 개체를 기반으로 새 **PSObject** 개체를 만듭니다.

  제공 된 개체가 System.object 형식이 면 제공 된 개체가 새 **PSObject** 개체의 기본 개체로 사용 됩니다. 제공 된 개체가 이미 **PSObject** 개체 이면 제공 된 개체가 그대로 반환 됩니다.

### <a name="base-adapted-and-extended-members"></a>기본, 조정 및 확장 멤버

개념적으로는 다음 용어를 사용 하 여 기본 개체의 원래 멤버와 PowerShell에서 추가 된 멤버 간의 관계를 보여 줍니다. **Psobject** 개체에서 사용 하는 특정 멤버 유형에 대 한 자세한 내용은 [psobject 클래스](/dotnet/api/system.management.automation.psobject)를 참조 하세요.

#### <a name="base-object-members"></a>기본 개체 멤버

**PSObject** 개체를 생성할 때 기본 개체가 지정 된 경우에는 members 속성을 통해 기본 개체의 멤버를 사용할 수 있습니다.

#### <a name="adapted-members"></a>조정 멤버

기본 개체가 메타 개체 인 경우 해당 속성에 포함 된 데이터를 "설명" 하는 일반적인 방식으로 데이터를 포함 하는 개체는 해당 개체를 **PSObject** 개체의 적용 된 멤버를 통해 데이터에 직접 액세스할 수 있도록 하는 뷰에 적용 합니다. 적용 되는 멤버 및 기본 개체 멤버는 Members 속성을 통해 액세스 됩니다.

#### <a name="extended-members"></a>확장 멤버

기본 개체에서 사용 가능한 멤버나 PowerShell에서 만든 해당 멤버 외에도 **PSObject** 는 원래 기본 개체를 스크립팅 환경에 유용한 추가 정보로 확장 하는 확장 멤버를 정의할 수 있습니다.

예를 들어, PowerShell에서 제공 하는 모든 핵심 cmdlet (예: Get Content 및 Set-Content cmdlet)은 path 매개 변수를 사용 합니다. 이러한 cmdlet 및 기타가 다른 형식의 개체에 대해 작동할 수 있도록 하기 위해 해당 개체에 경로 멤버를 추가 하 여 해당 정보를 모두 일반적인 방식으로 지정할 수 있습니다. 이 확장 된 경로 멤버를 사용 하면 기본 클래스에 경로 멤버가 없는 경우에도 cmdlet이 모든 형식에 대해 작동할 수 있습니다.

확장 멤버, 적용 된 멤버 및 기본 개체 멤버는 모두 Members 속성을 통해 액세스 됩니다.
